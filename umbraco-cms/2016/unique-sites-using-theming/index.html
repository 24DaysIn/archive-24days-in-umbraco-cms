<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">


	<title>How to Create Multiple Sites in One Install Using Theming</title>
<meta name="description" content="">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="/assets/24days-archive.css">
	<link rel="apple-touch-icon" href="/assets/24days-touch-icon.png">
		
	
	
</head>
<body>
	



<section class="page"><main class="article"><header><h1 class="header">Unique Sites Using Theming</h1>
      <p class="byline"> by Heather Floyd, <span class="pubdate">posted on <time datetime="2016-12-10">Dec 10, 2016</time></span></p></header><div class="notification warning">
      <h2>Heads Up!</h2>
      <p>
					This article is several years old now, and much has happened since then,
					so please keep that in mind while reading it.
				</p>
    </div>
    <div class="content-column">
      <p class="teaser">Why would you want to do that? Well, in cases where it makes sense, the advantage of maintaining a single codebase is huge - along with the efficiency provided by not having to duplicate 90% of website files (the Umbraco core components) and have multiple databases in order to host different websites.</p>
<p class="intro">Last year I had the opportunity to explore the possibilities of a themed installation when Scandia decided to move the uWestFest website to Umbraco Cloud hosting.</p>
<p>Previously, each year a new website installation was created to host that year's conference website, and between conferences a static "splash page" was put up at the <a href="http://uWestFest.com" target="_blank">uWestFest.com</a> domain. What if we could consolidate every year’s website into a single installation? Then we could continue to have the old sites online, for archival purposes, as well as facilitate faster development of the new site each year. Theming was the answer.</p>
<h2>Is Your Project a Good Fit for Theming?</h2>
<p>If you are considering using theming in your Umbraco installation, I suggest you think about whether the project requirements are a good fit. To arbitrarily stuff 10 different websites into a single install just because you can might cause more problems than it will solve.</p>
<p>The best application is one where you have visual variations on essentially the same sort of content. In the case of uWestFest, the conference has similar content each year: A schedule of sessions, biographies of speakers, info about ticket sales, venue, sponsorship, etc. Each year we have different visual branding, though, with sites looking and behaving in completely different ways.</p>
<p>Other good candidates for a themed installation:</p>
<ul>
<li>Sites managed by the same company, but with independent markets - like separate country sites for a brand</li>
<li>Multiple unique "microsites" for products managed by the same team (Individual books for a publisher, for instance)</li>
<li>Highly “designed” and customized landing pages </li>
</ul>
<h2>Architecture &amp; Design Considerations</h2>
<p>The reason your themed sites should share some similar content is that your Umbraco installation will contain all the Document Types needed to maintain each of the sites. Being able to use the same Document Types in various sites will keep the entire installation from becoming unwieldly.</p>
<p>Since the designs of each site will likely vary a great deal, you should design your Document Types according to <strong>content</strong> and <strong>data</strong> rather than page layout. Having structured content will give you a lot of precision when building out the site variations. For more free-form pages, use the Umbraco Grid control to handle design-specific content with maximum flexibility.</p>
<p>When creating your various site designs, here are two tips which will make the subsequent site implementations simpler:</p>
<ol>
<li><strong>Design with the content properties and grid in mind</strong> – Consider how the data you are already storing can be used in the design elements for various sites, and for less structured content, think about how the grid control can be used to provide specific design implementations – either by using multiple grid widgets to construct the design, or via custom macros.</li>
<li><strong>Using front-end frameworks can be helpful</strong> – If you can standardize on using a certain front-end framework (such as Bootstrap, Responsive Bp, etc.) across the different site designs, you will be able to re-use portions of template or macro code, and the grid markup will be consistent.</li>
</ol>
<h2>The Theme Logic</h2>
<p>The way that theming works in this arrangement is that Document Types have associated Templates as usual – with matching View files in the standard Umbraco “Views” folder.</p>
<p>When you create a new theme to use for a site, all the associated files are kept together in a single theme-named folder which contains two subfolders: “Assets” and “Views”.</p>
<ul>
<li>The “Assets” folder can contain whatever items are needed for the theme design – css, js, images, etc.</li>
<li>The “Views” folder contains any View files that should override the default ones with the same name for the theme.</li>
</ul>
<p>In practice, you can allow multiple Template choices for a Document Type, and whichever Template is selected for a given node will be used to render that specific node. Also, if you do not provide a themed version of a Template, the default View (from the main ‘Views” folder) will be used. (This is most useful for non-designed pages such as XML sitemaps.)</p>
<p>The routing to the themed View files is handled in a Default Controller which is simple to set up.</p>
<h2>Setup &amp; Components Needed</h2>
<p>To set up your themed sites, there are a few standard components you will need. (Some of these items have been adapted from Shannon’s "Articulate" code.)</p>
<h3><span>1. ThemeHelper.cs &amp; ThemePropertyEditorApiController.cs</span></h3>
<p>These can be added to App_Code or your compiled project code.</p>
<p><em>ThemeHelper.cs</em></p>
<pre><code class="language-csharp">﻿namespace MySite.Theming
{
    using System;
    using System.IO;
    using System.Web;
    using System.Web.Mvc;
    using System.Web.Mvc.Html;

    using ClientDependency.Core.Mvc;

    using Umbraco.Core;
    using Umbraco.Core.IO;
    using Umbraco.Core.Logging;

    public static class ThemeHelper
    {
        public enum PathType
        {
            ThemeRoot,
            View,
            PartialView,
            GridEditor
        };

        /// &lt;summary&gt;
        /// Returns the final path to the requested type, based on the theme and file existence.
        /// &lt;/summary&gt;
        /// &lt;param name="SiteThemeName"&gt;Theme Name&lt;/param&gt;
        /// &lt;param name="PathType"&gt;Type of Path to return&lt;/param&gt;
        /// &lt;param name="ViewName"&gt;Name of the View (without extension) (optional)&lt;/param&gt;
        /// &lt;param name="AlternateStandardPath"&gt;If the non-themed path is not standard, provide the full path here (optional)&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public static string GetFinalThemePath(string SiteThemeName, PathType PathType, string ViewName = "", string AlternateStandardPath = "")
        {
            if (SiteThemeName.IsNullOrWhiteSpace())
            {
                throw new InvalidOperationException("No theme has been set for this website root, republish the root with a selected theme.");
            }

            var finalPath = "";
            var standardPath = "";
            var themePath = "";

            var baseThemePath = string.Format("~/App_Plugins/Theming/Themes/{0}", SiteThemeName);

            switch (PathType)
            {
                case PathType.ThemeRoot:
                    themePath = string.Format("{0}/", baseThemePath);
                    standardPath = themePath;
                    break;

                case PathType.View:
                    standardPath = AlternateStandardPath !="" ? AlternateStandardPath : string.Format("~/Views/{0}.cshtml", ViewName);
                    themePath = string.Format("{0}/Views/{1}.cshtml", baseThemePath, ViewName);
                    break;

                case PathType.PartialView:
                    standardPath = AlternateStandardPath != "" ? AlternateStandardPath : string.Format("~/Views/Partials/{0}.cshtml", ViewName);
                    themePath = string.Format("{0}/Views/Partials/{1}.cshtml", baseThemePath, ViewName);
                    break;

                case PathType.GridEditor:
                    standardPath = AlternateStandardPath != "" ? AlternateStandardPath : string.Format("~/Views/Partials/Grid/Editors/{0}.cshtml", ViewName);
                    themePath = string.Format("{0}/Views/Partials/Grid/Editors/{1}.cshtml", baseThemePath, ViewName);
                    break;

                default:
                    break;
            }

            if (System.IO.File.Exists(IOHelper.MapPath(themePath)))
            {
                finalPath = themePath;
            }
            else
            {
                finalPath = standardPath;
            }

            return finalPath;
        }

        /// &lt;summary&gt;
        /// Shortcut for 'GetFinalThemePath()' with PathType.ThemeRoot
        /// &lt;/summary&gt;
        /// &lt;param name="SiteThemeName"&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public static string GetThemePath(string SiteThemeName)
        {
            var path = GetFinalThemePath(SiteThemeName, PathType.ThemeRoot);
            return path;
            }

        /// &lt;summary&gt;
        /// Shortcut for 'GetFinalThemePath()' with PathType.View
        /// &lt;/summary&gt;
        /// &lt;param name="SiteThemeName"&gt;&lt;/param&gt;
        /// &lt;param name="viewName"&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public static string GetThemeViewPath(string SiteThemeName, string ViewName)
        {
            var path = GetFinalThemePath(SiteThemeName, PathType.View, ViewName);
            return path;
            }

        /// &lt;summary&gt;
        /// Shortcut for 'GetFinalThemePath()' with PathType.PartialView
        /// &lt;/summary&gt;
        /// &lt;param name="SiteThemeName"&gt;&lt;/param&gt;
        /// &lt;param name="ViewName"&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public static string GetThemePartialViewPath(string SiteThemeName, string ViewName)
        {

            var path = GetFinalThemePath(SiteThemeName, PathType.PartialView, ViewName);
            return path;
            }

        public static string GetCssOverridePath(string CssOverrideFileName)
        {
            if (CssOverrideFileName.IsNullOrWhiteSpace())
            {
                return "";
            }
            else
            {
                var path = "/App_Plugins/Theming/CssOverrides/{0}";
                return string.Format(path, CssOverrideFileName);
            }
            
        }

        /// &lt;summary&gt;
        /// Returns the url of a themed asset
        /// ex: @Url.ThemedAsset(Model, "images/favicon.ico")
        /// NOTE: requires '@using ClientDependency.Core.Mvc' in View
        /// &lt;/summary&gt;
        /// &lt;param name="Url"&gt;UrlHelper&lt;/param&gt;
        /// &lt;param name="SiteThemeName"&gt;&lt;/param&gt;
        /// &lt;param name="RelativeAssetPath"&gt;Path to file inside [theme]/Assets/ folder&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public static string ThemedAsset(this UrlHelper url, string SiteThemeName, string RelativeAssetPath)
        {
            var themeRoot = GetFinalThemePath(SiteThemeName, PathType.ThemeRoot);
            return VirtualPathUtility.ToAbsolute(themeRoot).EnsureEndsWith('/') + "Assets/" + RelativeAssetPath;
        }

        #region HTML Helpers

        public static HtmlHelper RequiresThemedCss(this HtmlHelper html, string SiteThemeName, string FilePath)
        {
            var themeRoot = GetFinalThemePath(SiteThemeName, PathType.ThemeRoot);
            return html.RequiresCss(themeRoot + "Assets/css" + FilePath.EnsureStartsWith('/'));
        }

        public static HtmlHelper RequiresThemedJs(this HtmlHelper html, string SiteThemeName, string FilePath)
        {
            var themeRoot = GetFinalThemePath(SiteThemeName, PathType.ThemeRoot);
            return html.RequiresJs(themeRoot + "Assets/js" + FilePath.EnsureStartsWith('/'));
        }

        public static HtmlHelper RequiresThemedCssFolder(this HtmlHelper html, string SiteThemeName)
        {
            var themeRoot = GetFinalThemePath(SiteThemeName, PathType.ThemeRoot);
            return html.RequiresFolder(themeRoot + "Assets/css",
                100, "*.css", (absPath, pri) =&gt; html.RequiresCss(absPath, pri));

        }

        //TODO: This is only here as a hack until CDF 1.8.0 is released and shipped that fixes a bug
        private static HtmlHelper RequiresFolder(this HtmlHelper html, string folderPath, int priority, string fileSearch, Action&lt;string, int&gt; requiresAction)
        {
            var httpContext = html.ViewContext.HttpContext;
            var systemRootPath = httpContext.Server.MapPath("~/");
            var folderMappedPath = httpContext.Server.MapPath(folderPath);

            if (folderMappedPath.StartsWith(systemRootPath))
            {
                var files = Directory.GetFiles(folderMappedPath, fileSearch, SearchOption.TopDirectoryOnly);
                foreach (var file in files)
                {
                    var absoluteFilePath = "~/" + file.Substring(systemRootPath.Length).Replace("\\", "/");
                    requiresAction(absoluteFilePath, priority);
                    html.RequiresJs(absoluteFilePath, priority);
                }
            }

            return html;
        }

        public static HtmlHelper RequiresThemedJsFolder(this HtmlHelper html, string SiteThemeName)
        {
            var themeRoot = GetFinalThemePath(SiteThemeName, PathType.ThemeRoot);
            return html.RequiresJsFolder(themeRoot + "Assets/js");
        }

        /// &lt;summary&gt;
        /// Renders a partial view in the current theme
        /// &lt;/summary&gt;
        /// &lt;param name="html"&gt;&lt;/param&gt;
        /// &lt;param name="SiteThemeName"&gt;&lt;/param&gt;
        /// &lt;param name="PartialName"&gt;&lt;/param&gt;
        /// &lt;param name="ViewModel"&gt;&lt;/param&gt;
        /// &lt;param name="ViewData"&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public static IHtmlString ThemedPartial(this HtmlHelper html, string SiteThemeName, string PartialName, object ViewModel, ViewDataDictionary ViewData = null)
        {
            try
            {
                var path = GetFinalThemePath(SiteThemeName, PathType.PartialView, PartialName); 
                return html.Partial(path, ViewModel, ViewData);
            }
            catch (Exception ex)
            {
                var msg = string.Format("Error rendering partial view '{0}'", PartialName);
                LogHelper.Error&lt;IHtmlString&gt;(msg, ex);
                return new HtmlString(string.Format("&lt;span class=\"error\"&gt;{0}&lt;/span&gt;", msg));
            }
        }

        /// &lt;summary&gt;
        /// Renders a partial view in the current theme
        /// &lt;/summary&gt;
        /// &lt;param name="html"&gt;&lt;/param&gt;
        /// &lt;param name="SiteThemeName"&gt;&lt;/param&gt;
        /// &lt;param name="PartialName"&gt;&lt;/param&gt;
        /// &lt;param name="ViewData"&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public static IHtmlString ThemedPartial(this HtmlHelper html, string SiteThemeName, string PartialName, ViewDataDictionary ViewData = null)
        {
            if (ViewData == null)
            {
                ViewData = html.ViewData;
            }
            try
            {
                var path = GetFinalThemePath(SiteThemeName,  PathType.PartialView ,PartialName);
                return html.Partial(path, ViewData);
            }
            catch (Exception ex)
            {
                var msg = string.Format("Error rendering partial view '{0}'", PartialName);
                LogHelper.Error&lt;IHtmlString&gt;(msg, ex);
                return new HtmlString(string.Format("&lt;span class=\"error\"&gt;{0}&lt;/span&gt;", msg));
            }

        }
        #endregion
    }

}
</code></pre>
<p><em>ThemePropertyEditorApiController.cs</em></p>
<pre><code class="language-csharp">﻿namespace MySite.Theming
{
    using System.Collections.Generic;
    using System.IO;
    using System.Linq;
    using System.Web.Http;

    using Umbraco.Core.IO;
    using Umbraco.Web.WebApi;

    public class ThemePropertyEditorApiController : UmbracoApiController
    {
        //  /Umbraco/Api/ThemePropertyEditorApi/GetThemes
        [HttpGet]
        public IEnumerable&lt;string&gt; GetThemes()
        {
            var dir = IOHelper.MapPath("~/App_Plugins/Theming/Themes");
            var allDirs =  Directory.GetDirectories(dir).Select(x =&gt; new DirectoryInfo(x).Name);
            return allDirs;
        }
    }
  
}
</code></pre>
<h3>2. App_Plugins Theming</h3>
<p>Includes the back-office bits for ThemePropertyEditor and the “Themes” folder where all individual theme sets reside.</p>
<p><img style="width: 163px; height: 365px; border: 1px solid #000;" src="/archive/media/2016/appplugins_theming_structure.png?width=163&amp;height=365" alt="" width="163" height="365" rel="1401" data-id="1401"></p>
<p><a data-id="1393" href="/archive/media/2016/app_plugins-theming.zip" title="App_Plugins-Theming.zip">Download "Theming" files and folders in a handy ZIP file</a></p>
<p>Technically, you could also move the “Themes” folder somewhere else in the site tree – as long as you update the path in the ThemeHelper.cs and ThemePropertyEditorApiController.cs files.</p>
<h3>3. “Site Theme” Datatype and Property</h3>
<p>Using the “ThemePropertyEditor”, create a datatype and add it to your “level 1” Document Type (something like “Site” or “Homepage”) with the property alias “SiteTheme”. This will allow you to select an available Theme folder at the site root for each site.</p>
<h3>4. Update the Default Controller to use theming</h3>
<p>This default controller code will replace the current template view with the themed version, if available, on page render. Use the “ApplicationStarting” event to set the Default Controller for the entire application.</p>
<p><em>DefaultController.cs</em></p>
<pre><code class="language-csharp">﻿namespace MySite.Controllers
{
    using System.Web.Mvc;

    using MySite.Theming;

    using Umbraco.Web;
    using Umbraco.Web.Models;

    /// &lt;summary&gt;
    /// The default controller.
    /// &lt;/summary&gt;
    /// &lt;remarks&gt;
    /// If route hijacking doesn't find a controller it will use this controller.
    /// &lt;/remarks&gt;
    public class DefaultController : Umbraco.Web.Mvc.SurfaceController
    {
        /// &lt;summary&gt;
        /// The default controller method
        /// &lt;/summary&gt;
        /// &lt;param name="model"&gt;
        /// The model.
        /// &lt;/param&gt;
        /// &lt;returns&gt;
        /// The &lt;see cref="ActionResult"/&gt; to render the basic view model
        /// &lt;/returns&gt;
        public override ActionResult Index(RenderModel model)
        {
            var currentTemplateName = model.Content.GetTemplateAlias();
            var siteTheme = model.Content.AncestorOrSelf(1).GetPropertyValue&lt;string&gt;("SiteTheme");
            var templatePath = ThemeHelper.GetFinalThemePath(siteTheme, ThemeHelper.PathType.View, currentTemplateName);

            return View(templatePath, model);
        }

    }
}</code></pre>
<p><em>UmbracoEvents.cs</em></p>
<pre><code class="language-csharp">﻿namespace MySite.Events
{
    using System;
    using Controllers;
    using Examine;
    using Umbraco.Core;
    using Umbraco.Core.Events;
    using Umbraco.Core.Logging;
    using Umbraco.Core.Models;
    using Umbraco.Core.Publishing;
    using Umbraco.Core.Services;
    using Umbraco.Web.Mvc;

    /// &lt;summary&gt;
    /// Registers site specific Umbraco application event handlers
    /// &lt;/summary&gt;
    public class UmbracoEvents : ApplicationEventHandler
    {

        protected override void ApplicationStarting(UmbracoApplicationBase umbracoApplication, ApplicationContext applicationContext)
        {
           
            try
            {
                //// By registering this here we can make sure that if route hijacking doesn't find a controller it will use this controller.
                //// That way each page will always be routed through one of our controllers.
                DefaultRenderMvcControllerResolver.Current.SetDefaultControllerType(typeof(DefaultController));
                base.ApplicationStarting(umbracoApplication, applicationContext);

                LogHelper.Info&lt;UmbracoEvents&gt;("Default render mvc controller successfully reassigned");
            }
            catch (Exception ex)
            {
                LogHelper.Error&lt;UmbracoEvents&gt;("Failed to reassign default render mvc controller", ex);
            }

        }

    }
}</code></pre>
<h3>5. Base Templates</h3>
<p>As you create your Document Types, go ahead and create the Templates along with them in the standard fashion. Even if the related View files are essentially empty, having them present in the “~/Views” folder will prevent YSOD errors. When creating a theme, just create themed View files with the same names, but in your Theme’s “Views” folder.</p>
<h3>6. Base Macros</h3>
<p>You can create themed versions of macros as well. First, create the Macro via the back-office as usual, and update the code in the MacroPartial file to use the current site’s theme to render the associated theme file.</p>
<p><em>Example:</em></p>
<p><em>General Macro File (~/Views/MacroPartials/ArticlesListing.cshtml)</em></p>
<pre><code class="language-javascript">@using MySite.Theming
@using Umbraco.Core.Logging

@inherits Umbraco.Web.Macros.PartialViewMacroPage

@{
     var siteTheme = model.Content.AncestorOrSelf(1).GetPropertyValue&lt;string&gt;("SiteTheme");
}

@Html.ThemedPartial(siteTheme, "Macro_ArticlesListing")

</code></pre>
<p>Then add a customized macro file in your “~/App_Plugins/Theming/Themes/MyTheme/Views/Partials/” folder with the name "Macro_ArticlesListing.cshtml"</p>
<h3>7. Base Grid Editors + Updated Grid Rendering file</h3>
<p>Similar to the other types of view files, you can create basic grid editor files (located at “~/Views/Partials/Grid/Editors/”), which will be used by default. With a small update to your grid rendering file, you can also create grid widget overrides in an equivalent Theme folder (“~/App_Plugins/Theming/Themes/MyTheme/Views/Partials/Grid/Editors/”).</p>
<p><em>grid-renderer-example.cshtml</em></p>
<pre><code class="language-javascript">﻿@inherits UmbracoViewPage&lt;dynamic&gt;
@using Umbraco.Web.Templates
@using Newtonsoft.Json.Linq
@using MySite.Theming

@{
	//******* Support Theming of Widgets *******
	var themeName = "";
    var site = Umbraco.TypedContent(Umbraco.AssignedContentItem).AncestorOrSelf(1) ;
    if (site != null)
    {
        themeName = site.GetPropertyValue&lt;string&gt;("SiteTheme");
    }

    var currentThemePath = ThemeHelper.GetThemePath(themeName);

    ViewBag.CurrentThemeName = themeName;
    ViewBag.CurrentThemePath = currentThemePath;
}

@if (Model != null &amp;&amp; Model.sections != null)
{
    var oneColumn = ((System.Collections.ICollection)Model.sections).Count == 1;

    &lt;div class="umb-grid"&gt;
         @if (oneColumn)
        {
            foreach (var section in Model.sections) {
                &lt;div class="grid-section"&gt;
                    @foreach (var row in section.rows) {
                        @renderRow(row, true);
                    }
                &lt;/div&gt;
            }
        }else { 
            &lt;div class="container"&gt;
                &lt;div class="row clearfix"&gt;
                    @foreach (var s in Model.sections) {
                        &lt;div class="grid-section"&gt;
                            &lt;div class="@("span" + s.grid) column"&gt;
                                @foreach (var row in s.rows) {
                                    @renderRow(row, false);
                                }
                            &lt;/div&gt;
                        &lt;/div&gt;
                    }
                &lt;/div&gt;
            &lt;/div&gt;
        }
    &lt;/div&gt;
}

@helper renderRow(dynamic row, bool singleColumn){
    &lt;div @RenderElementAttributes(row)&gt;
        @Umbraco.If(singleColumn, "&lt;div class='container'&gt;")
        &lt;div class="row clearfix"&gt;
            @foreach ( var area in row.areas ) {
            &lt;div class="@("span" + area.grid) column"&gt;
                &lt;div @RenderElementAttributes(area)&gt;
                    @foreach (var control in area.controls) {
                            if (control != null &amp;&amp; control.editor != null &amp;&amp; control.editor.view != null)
                            {
								//******* Support Theming of Widgets *******
								var finalViewPath = "grid/editors/base";
								var themeName = ViewBag.CurrentThemeName;
								if (themeName != "")
								{
									var viewFileName = "Base";

									finalViewPath = ThemeHelper.GetFinalThemePath(themeName, ThemeHelper.PathType.GridEditor, viewFileName);
								}

								&lt;text&gt;@Html.Partial(finalViewPath, (object)control)&lt;/text&gt;

                            }
                        }
                    &lt;/div&gt;
            &lt;/div&gt;}
        &lt;/div&gt;
        @Umbraco.If(singleColumn, "&lt;/div&gt;")
    &lt;/div&gt;
}

@functions {

    public static MvcHtmlString RenderElementAttributes(dynamic contentItem)
    {
        var attrs = new List&lt;string&gt;();
        JObject cfg = contentItem.config;

        if(cfg != null)
            foreach (JProperty property in cfg.Properties()) {
                attrs.Add(property.Name + "=\"" + property.Value.ToString() + "\"");
        }

        JObject style = contentItem.styles;

        if (style != null) { 
            var cssVals = new List&lt;string&gt;();
            foreach (JProperty property in style.Properties())
                cssVals.Add(property.Name + ":" + property.Value.ToString() + ";");

            if (cssVals.Any())
                attrs.Add("style=\"" + string.Join(" ", cssVals) + "\"");
            }

        return new MvcHtmlString(string.Join(" ", attrs));
    }
}</code></pre>
<h2>Adding New Themed Sites to Your Installation</h2>
<p>Once you have the basic components in place, you can begin adding themed sites. Create a folder for the new Theme and select it on the root site/home node for the new site, add you page nodes and customize the theme View files as needed.</p>
<p>Some HtmlHelpers which will assist with your theme development:</p>
<pre><code class="language-javascript">

@{ var thisTheme = Model.Content.AncestorOrSelf(1).GetPropertyValue&lt;string&gt;("SiteTheme"); }

&lt;!-- Include a specific file--&gt;
&lt;script type="text/javascript" src="@Url.ThemedAsset(thisTheme,"js/site.min.js")"&gt;&lt;/script&gt;
&lt;link rel="stylesheet" type="text/css" href="@Url.ThemedAsset(thisTheme, "css/main.min.css")" /&gt;

&lt;!-- Include all files in theme's "js" folder --&gt;
@Html.RequiresThemedJsFolder(thisTheme)

&lt;!-- Include all files in theme's "css" folder --&gt;
@Html.RequiresThemedCssFolder(thisTheme)

&lt;!-- Example of image insertion --&gt;
&lt;img class="logo" src="@Url.ThemedAsset(thisTheme, "img/logo.png")" alt="..." /&gt;

&lt;!-- Insert a themed partial (automatically falls back to the default Views/Partials/ folder if not found)--&gt;
@Html.ThemedPartial(thisTheme, "Nav_Main", Model)

&lt;!-- Insert a Cached themed partial --&gt;
@Html.CachedPartial(ThemeHelper.GetThemePartialViewPath(thisTheme, "Footer"), Model, 10, true, false)</code></pre>
<p>For one-off design elements which don’t neatly fit your existing grid widgets or macros, you can use a “Code Snippet” widget to pass in straight HTML/JS or the path to a very customized partial view for rendering inside your grid. A bit of coding creativity will ensure all your needs are met.</p>
<p>You’ll find that individual site development can go pretty quickly once you have the basic Document Types and theming setup in your application.  You can spend your time working on more elaborate front-end designs and interactions, or just putting together solid content.</p>
<hr>
<p><strong>Heather Floyd</strong> is a Senior Umbraco Developer at Scandia where she enjoys creating architecturally elegant Umbraco websites. She blogs occasionally at <a href="http://HeatherFloyd.com" target="_blank">HeatherFloyd.com</a>.</p>
<p><strong>Scandia</strong> is a boutique web and app development agency that specializes in Umbraco for financial industries.  Learn more at <a href="http://MyScandia.com" target="_blank">MyScandia.com</a>. </p>
<p> </p>
    </div><footer><ul class="tags">
        <li><a rel="tag" href="https://24days.in/umbraco-cms/tags/v7/" title="See all articles tagged with v7">v7</a></li>
        <li><a rel="tag" href="https://24days.in/umbraco-cms/tags/configuration/" title="See all articles tagged with Configuration">Configuration</a></li>
        <li><a rel="tag" href="https://24days.in/umbraco-cms/tags/content/" title="See all articles tagged with Content">Content</a></li>
        <li><a rel="tag" href="https://24days.in/umbraco-cms/tags/information-architecture/" title="See all articles tagged with Information architecture">Information architecture</a></li>
        <li><a rel="tag" href="https://24days.in/umbraco-cms/tags/templates/" title="See all articles tagged with Templates">Templates</a></li>
      </ul></footer><section class="bios"><div class="bio">
        <div class="gravatar" title="Heather Floyd"><img src="//gravatar.com/avatar/e987a7108f5687d9fd4c25aec9fd322b.jpg?d=mm&amp;s=150" srcset="//gravatar.com/avatar/e987a7108f5687d9fd4c25aec9fd322b.jpg?d=mm&amp;s=300 2x" width="150" height="150"></div>
        <h1>Heather Floyd</h1>
        <p>Heather is on Twitter as <a href="//twitter.com/HFloyd" title="Heather Floyd on Twitter" rel="author">@HFloyd</a></p>
      </div></section><section class="comments"><div id="disqus_thread"></div></section></main><nav class="dates-navbar"><a href="/umbraco-cms/2016/" class="home-link"><span class="scr-text">Home</span></a><ol>
      <li><a href="/umbraco-cms/2016/umbraco-forms-and-newsletter-studio/" title="Umbraco Forms and Newsletter Studio"><span class="scr-text">Umbraco Forms and Newsletter Studio</span></a></li>
      <li><a href="/umbraco-cms/2016/moving-to-umbracoland/" title="Moving to Umbracoland"><span class="scr-text">Moving to Umbracoland</span></a></li>
      <li><a href="/umbraco-cms/2016/pipeline-crm-and-umbraco-forms/" title="Pipeline CRM and Umbraco Forms"><span class="scr-text">Pipeline CRM and Umbraco Forms</span></a></li>
      <li><a href="/umbraco-cms/2016/modular-development/" title="Modular Development"><span class="scr-text">Modular Development</span></a></li>
      <li><a href="/umbraco-cms/2016/custom-property-editor-tutorial/" title="Custom Property Editor Tutorial"><span class="scr-text">Custom Property Editor Tutorial</span></a></li>
      <li><a href="/umbraco-cms/2016/custom-list-view-layouts/" title="Custom List View Layouts"><span class="scr-text">Custom List View Layouts</span></a></li>
      <li><a href="/umbraco-cms/2016/cms-for-the-internet-of-things/" title="CMS for the Internet Of Things"><span class="scr-text">CMS for the Internet Of Things</span></a></li>
      <li><a href="/umbraco-cms/2016/custom-data-and-examine-searching/" title="Custom data and Examine searching"><span class="scr-text">Custom data and Examine searching</span></a></li>
      <li><a href="/umbraco-cms/2016/getting-comfortable-with-umbraco-cloud/" title="Getting comfortable with Umbraco Cloud"><span class="scr-text">Getting comfortable with Umbraco Cloud</span></a></li>
      <li class="selected"><a href="/umbraco-cms/2016/unique-sites-using-theming/" title="Unique Sites Using Theming"><span class="scr-text">Unique Sites Using Theming</span></a></li>
      <li><a href="/umbraco-cms/2016/importance-of-side-projects/" title="Importance of side projects"><span class="scr-text">Importance of side projects</span></a></li>
      <li><a href="/umbraco-cms/2016/first-time-with-umbraco-cloud/" title="First time with Umbraco Cloud"><span class="scr-text">First time with Umbraco Cloud</span></a></li>
      <li><a href="/umbraco-cms/2016/friendly-backoffice/" title="Friendly Backoffice"><span class="scr-text">Friendly Backoffice</span></a></li>
      <li><a href="/umbraco-cms/2016/using-your-voice-better/" title="Using your voice better"><span class="scr-text">Using your voice better</span></a></li>
      <li><a href="/umbraco-cms/2016/continuous-deployment-of-umbraco/" title="Continuous Deployment of Umbraco"><span class="scr-text">Continuous Deployment of Umbraco</span></a></li>
      <li><a href="/umbraco-cms/2016/umbraco-edge-case-stories/" title="Umbraco edge case stories"><span class="scr-text">Umbraco edge case stories</span></a></li>
      <li><a href="/umbraco-cms/2016/web-components/" title="Web Components"><span class="scr-text">Web Components</span></a></li>
      <li><a href="/umbraco-cms/2016/the-content-tree-is-dead/" title="The Content Tree is Dead"><span class="scr-text">The Content Tree is Dead</span></a></li>
      <li><a href="/umbraco-cms/2016/authenticating-with-ad-fs-and-identityextensions/" title="Authenticating with AD FS and IdentityExtensions"><span class="scr-text">Authenticating with AD FS and IdentityExtensions</span></a></li>
      <li><a href="/umbraco-cms/2016/getting-started-with-modelsbuilder/" title="Getting started with ModelsBuilder"><span class="scr-text">Getting started with ModelsBuilder</span></a></li>
      <li><a href="/umbraco-cms/2016/umbraco-extensibility/" title="Umbraco extensibility"><span class="scr-text">Umbraco extensibility</span></a></li>
      <li><a href="/umbraco-cms/2016/adding-umbraco-to-existing-site/" title="Adding Umbraco to existing site"><span class="scr-text">Adding Umbraco to existing site</span></a></li>
      <li><a href="/umbraco-cms/2016/polls-in-umbraco/" title="Polls in Umbraco"><span class="scr-text">Polls in Umbraco</span></a></li>
      <li><a href="/umbraco-cms/2016/into-the-cloud/" title="Into the Cloud"><span class="scr-text">Into the Cloud</span></a></li>
    </ol></nav></section>


	<script type="module" src="/assets/ipuzzler.js"></script>
	<script defer src="/assets/libs.min.js"></script>
	<script defer src="/assets/app.js"></script>
	
</body>
</html>
